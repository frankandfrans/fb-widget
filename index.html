<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Frank & Fran's Fishing Report</title>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #e9eff5;
    color: #0b2653;
    display: flex;
    height: 100vh;
}
#text {
    flex: 1;
    padding: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: left;
    font-weight: 800;
    font-size: clamp(24px, 5vw, 70px);
    line-height: 1.2;
}
#image {
    flex: 1;
    background-color: #ccc;
    display: flex;
    align-items: center;
    justify-content: center;
}
#image img {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
}
</style>
</head>
<body>
<div id="text">Loading latest fishing report...</div>
<div id="image"><em>Loading image...</em></div>
<script>
async function loadPost() {
    const res = await fetch("/api/posts");
    const data = await res.json();
    const post = data.message || "No report found.";
    const images = (data.attachments?.data ?? []).map(img => img.media?.image?.src).filter(Boolean);

    document.getElementById("text").innerText = post;

    if (images.length) {
        let index = 0;
        const imgEl = document.createElement("img");
        imgEl.src = images[0];
        document.getElementById("image").innerHTML = "";
        document.getElementById("image").appendChild(imgEl);

        setInterval(() => {
            index = (index + 1) % images.length;
            imgEl.src = images[index];
        }, 5000);
    } else {
        document.getElementById("image").innerHTML = "<em>No image available.</em>";
    }
}

loadPost();
</script>
</body>
</html>